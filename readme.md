# Отчет по оборотам бонусов

Скрипт для агрегации данных по начислению и списанию бонусов из Excel файлов с фильтрацией по маркам топлива и АЗС.

## Установка

```bash
pip install pandas openpyxl python-calamine tqdm
```

## Использование

```bash
python bonus_report.py
```

Скрипт обрабатывает все файлы `Report*.xlsx` в текущей директории и создает сводный отчет.

## Настройка фильтров

Откройте файл и отредактируйте секцию `CONFIG["FILTERS"]`:

**Исключить марки топлива:**
```python
"EXCLUDE_FUEL_MARKS": [
    18,    # ГАЗ
    # 14,  # Аи-92-К5
    # 15,  # Аи-95-К5
],
```

**Исключить АЗС:**
```python
"EXCLUDE_AZS": [
    1116,  # Номер АЗС
],
```

**Отключить фильтрацию:**
```python
"ENABLE_FILTERING": False,
```

## Требования к данным

Excel файлы должны содержать лист `ВсеЗаправки` с колонками:
- `Время` - дата заправки
- `Бонусов+` - начисленные бонусы
- `Бонусов-` - списанные бонусы
- `Объем` - литры
- `Основание` - основание операции
- `Станция` - номер АЗС
- `Марка` - код марки топлива

## Результат

Файл `Отчёт_по_оборотам_бонусов_ПЛ_ОРТК_2024_2025.xlsx` с агрегацией по месяцам:
- Бонусов начислено
- Бонусов списано
- Продано литров (с бонусами / всего)
- Коэффициент начисления на 1 литр

## Справочник марок

| Код | Марка |
|-----|-------|
| 14 | Аи-92-К5 |
| 15 | Аи-95-К5 |
| 17 | ДТ-Л-К5 |
| 18 | ГАЗ |
| 19 | Аи-95-К5PR |
| 21 | Аи100-К5PR |